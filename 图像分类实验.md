# 图像分类实验
陈乐昕 2020-10-13

[toc]

## 图像处理环境基础
图像处理库: opencv, PIL(Pillow)
## 建立简单的神经网络
有两种方式进行图像的分类实验：
- 预训练好神经网络
- 自定义神经网络

分别以两种方式来做简单的实验

## 预训练好的神经网络
这种方法是定义一些神经网络，并利用imagenet大规模图像集进行训练，训练好的网络的权重可以下载。 具体的模型的定义请参考：
https://github.com/pytorch/vision/tree/master/torchvision/models


```python
import torch
import torchvision
from torchvision import datasets, models, transforms
```

### 1 定义好的网络结构，并加载训练好的权重


```python
# 定义好的网络结构
resnet50 = models.resnet50(pretrained=True)
resnet50.load_state_dict(torch.load('C:\\Users\\Doiya\\.cache\\torch\\hub\\checkpoints\\resnet50-19c8e357.pth'))
```




    <All keys matched successfully>




```python
# 显示网络结构，看看具体的结构
print(resnet50)
```


```python
from PIL import Image
img = Image.open("./2.jpg")
```


```python
from torchvision import transforms
transform = transforms.Compose([            #[1]
 transforms.Resize(256),                    #[2]
 transforms.CenterCrop(224),                #[3]
 transforms.ToTensor(),                     #[4]
 transforms.Normalize(                      #[5]
 mean=[0.485, 0.456, 0.406],                #[6]
 std=[0.229, 0.224, 0.225]                  #[7]
 )])
```


```python
img_t = transform(img)
```


```python
img_t.shape
```




    torch.Size([3, 224, 224])




```python
b_t=torch.unsqueeze(img_t, 0)
```


```python
b_t.shape
```




    torch.Size([1, 3, 224, 224])




```python
resnet50.eval()
out = resnet50(b_t)
print(out.shape)
```

    torch.Size([1, 1000])



```python
with open('imagenet_classes.txt') as f:
  classes = [line.strip() for line in f.readlines()]
```


```python
classes
```




    ['0, tench',
     '1, goldfish',
     '2, great_white_shark',
     '3, tiger_shark',
     '4, hammerhead',
     '5, electric_ray',
     '6, stingray',
     '7, cock',
     '8, hen',
     '9, ostrich',
     '10, brambling',
     '11, goldfinch',
     '12, house_finch',
     '13, junco',
     '14, indigo_bunting',
     '15, robin',
     '16, bulbul',
     '17, jay',
     '18, magpie',
     '19, chickadee',
     '20, water_ouzel',
     '21, kite',
     '22, bald_eagle',
     '23, vulture',
     '24, great_grey_owl',
     '25, European_fire_salamander',
     '26, common_newt',
     '27, eft',
     '28, spotted_salamander',
     '29, axolotl',
     '30, bullfrog',
     '31, tree_frog',
     '32, tailed_frog',
     '33, loggerhead',
     '34, leatherback_turtle',
     '35, mud_turtle',
     '36, terrapin',
     '37, box_turtle',
     '38, banded_gecko',
     '39, common_iguana',
     '40, American_chameleon',
     '41, whiptail',
     '42, agama',
     '43, frilled_lizard',
     '44, alligator_lizard',
     '45, Gila_monster',
     '46, green_lizard',
     '47, African_chameleon',
     '48, Komodo_dragon',
     '49, African_crocodile',
     '50, American_alligator',
     '51, triceratops',
     '52, thunder_snake',
     '53, ringneck_snake',
     '54, hognose_snake',
     '55, green_snake',
     '56, king_snake',
     '57, garter_snake',
     '58, water_snake',
     '59, vine_snake',
     '60, night_snake',
     '61, boa_constrictor',
     '62, rock_python',
     '63, Indian_cobra',
     '64, green_mamba',
     '65, sea_snake',
     '66, horned_viper',
     '67, diamondback',
     '68, sidewinder',
     '69, trilobite',
     '70, harvestman',
     '71, scorpion',
     '72, black_and_gold_garden_spider',
     '73, barn_spider',
     '74, garden_spider',
     '75, black_widow',
     '76, tarantula',
     '77, wolf_spider',
     '78, tick',
     '79, centipede',
     '80, black_grouse',
     '81, ptarmigan',
     '82, ruffed_grouse',
     '83, prairie_chicken',
     '84, peacock',
     '85, quail',
     '86, partridge',
     '87, African_grey',
     '88, macaw',
     '89, sulphur-crested_cockatoo',
     '90, lorikeet',
     '91, coucal',
     '92, bee_eater',
     '93, hornbill',
     '94, hummingbird',
     '95, jacamar',
     '96, toucan',
     '97, drake',
     '98, red-breasted_merganser',
     '99, goose',
     '100, black_swan',
     '101, tusker',
     '102, echidna',
     '103, platypus',
     '104, wallaby',
     '105, koala',
     '106, wombat',
     '107, jellyfish',
     '108, sea_anemone',
     '109, brain_coral',
     '110, flatworm',
     '111, nematode',
     '112, conch',
     '113, snail',
     '114, slug',
     '115, sea_slug',
     '116, chiton',
     '117, chambered_nautilus',
     '118, Dungeness_crab',
     '119, rock_crab',
     '120, fiddler_crab',
     '121, king_crab',
     '122, American_lobster',
     '123, spiny_lobster',
     '124, crayfish',
     '125, hermit_crab',
     '126, isopod',
     '127, white_stork',
     '128, black_stork',
     '129, spoonbill',
     '130, flamingo',
     '131, little_blue_heron',
     '132, American_egret',
     '133, bittern',
     '134, crane',
     '135, limpkin',
     '136, European_gallinule',
     '137, American_coot',
     '138, bustard',
     '139, ruddy_turnstone',
     '140, red-backed_sandpiper',
     '141, redshank',
     '142, dowitcher',
     '143, oystercatcher',
     '144, pelican',
     '145, king_penguin',
     '146, albatross',
     '147, grey_whale',
     '148, killer_whale',
     '149, dugong',
     '150, sea_lion',
     '151, Chihuahua',
     '152, Japanese_spaniel',
     '153, Maltese_dog',
     '154, Pekinese',
     '155, Shih-Tzu',
     '156, Blenheim_spaniel',
     '157, papillon',
     '158, toy_terrier',
     '159, Rhodesian_ridgeback',
     '160, Afghan_hound',
     '161, basset',
     '162, beagle',
     '163, bloodhound',
     '164, bluetick',
     '165, black-and-tan_coonhound',
     '166, Walker_hound',
     '167, English_foxhound',
     '168, redbone',
     '169, borzoi',
     '170, Irish_wolfhound',
     '171, Italian_greyhound',
     '172, whippet',
     '173, Ibizan_hound',
     '174, Norwegian_elkhound',
     '175, otterhound',
     '176, Saluki',
     '177, Scottish_deerhound',
     '178, Weimaraner',
     '179, Staffordshire_bullterrier',
     '180, American_Staffordshire_terrier',
     '181, Bedlington_terrier',
     '182, Border_terrier',
     '183, Kerry_blue_terrier',
     '184, Irish_terrier',
     '185, Norfolk_terrier',
     '186, Norwich_terrier',
     '187, Yorkshire_terrier',
     '188, wire-haired_fox_terrier',
     '189, Lakeland_terrier',
     '190, Sealyham_terrier',
     '191, Airedale',
     '192, cairn',
     '193, Australian_terrier',
     '194, Dandie_Dinmont',
     '195, Boston_bull',
     '196, miniature_schnauzer',
     '197, giant_schnauzer',
     '198, standard_schnauzer',
     '199, Scotch_terrier',
     '200, Tibetan_terrier',
     '201, silky_terrier',
     '202, soft-coated_wheaten_terrier',
     '203, West_Highland_white_terrier',
     '204, Lhasa',
     '205, flat-coated_retriever',
     '206, curly-coated_retriever',
     '207, golden_retriever',
     '208, Labrador_retriever',
     '209, Chesapeake_Bay_retriever',
     '210, German_short-haired_pointer',
     '211, vizsla',
     '212, English_setter',
     '213, Irish_setter',
     '214, Gordon_setter',
     '215, Brittany_spaniel',
     '216, clumber',
     '217, English_springer',
     '218, Welsh_springer_spaniel',
     '219, cocker_spaniel',
     '220, Sussex_spaniel',
     '221, Irish_water_spaniel',
     '222, kuvasz',
     '223, schipperke',
     '224, groenendael',
     '225, malinois',
     '226, briard',
     '227, kelpie',
     '228, komondor',
     '229, Old_English_sheepdog',
     '230, Shetland_sheepdog',
     '231, collie',
     '232, Border_collie',
     '233, Bouvier_des_Flandres',
     '234, Rottweiler',
     '235, German_shepherd',
     '236, Doberman',
     '237, miniature_pinscher',
     '238, Greater_Swiss_Mountain_dog',
     '239, Bernese_mountain_dog',
     '240, Appenzeller',
     '241, EntleBucher',
     '242, boxer',
     '243, bull_mastiff',
     '244, Tibetan_mastiff',
     '245, French_bulldog',
     '246, Great_Dane',
     '247, Saint_Bernard',
     '248, Eskimo_dog',
     '249, malamute',
     '250, Siberian_husky',
     '251, dalmatian',
     '252, affenpinscher',
     '253, basenji',
     '254, pug',
     '255, Leonberg',
     '256, Newfoundland',
     '257, Great_Pyrenees',
     '258, Samoyed',
     '259, Pomeranian',
     '260, chow',
     '261, keeshond',
     '262, Brabancon_griffon',
     '263, Pembroke',
     '264, Cardigan',
     '265, toy_poodle',
     '266, miniature_poodle',
     '267, standard_poodle',
     '268, Mexican_hairless',
     '269, timber_wolf',
     '270, white_wolf',
     '271, red_wolf',
     '272, coyote',
     '273, dingo',
     '274, dhole',
     '275, African_hunting_dog',
     '276, hyena',
     '277, red_fox',
     '278, kit_fox',
     '279, Arctic_fox',
     '280, grey_fox',
     '281, tabby',
     '282, tiger_cat',
     '283, Persian_cat',
     '284, Siamese_cat',
     '285, Egyptian_cat',
     '286, cougar',
     '287, lynx',
     '288, leopard',
     '289, snow_leopard',
     '290, jaguar',
     '291, lion',
     '292, tiger',
     '293, cheetah',
     '294, brown_bear',
     '295, American_black_bear',
     '296, ice_bear',
     '297, sloth_bear',
     '298, mongoose',
     '299, meerkat',
     '300, tiger_beetle',
     '301, ladybug',
     '302, ground_beetle',
     '303, long-horned_beetle',
     '304, leaf_beetle',
     '305, dung_beetle',
     '306, rhinoceros_beetle',
     '307, weevil',
     '308, fly',
     '309, bee',
     '310, ant',
     '311, grasshopper',
     '312, cricket',
     '313, walking_stick',
     '314, cockroach',
     '315, mantis',
     '316, cicada',
     '317, leafhopper',
     '318, lacewing',
     '319, dragonfly',
     '320, damselfly',
     '321, admiral',
     '322, ringlet',
     '323, monarch',
     '324, cabbage_butterfly',
     '325, sulphur_butterfly',
     '326, lycaenid',
     '327, starfish',
     '328, sea_urchin',
     '329, sea_cucumber',
     '330, wood_rabbit',
     '331, hare',
     '332, Angora',
     '333, hamster',
     '334, porcupine',
     '335, fox_squirrel',
     '336, marmot',
     '337, beaver',
     '338, guinea_pig',
     '339, sorrel',
     '340, zebra',
     '341, hog',
     '342, wild_boar',
     '343, warthog',
     '344, hippopotamus',
     '345, ox',
     '346, water_buffalo',
     '347, bison',
     '348, ram',
     '349, bighorn',
     '350, ibex',
     '351, hartebeest',
     '352, impala',
     '353, gazelle',
     '354, Arabian_camel',
     '355, llama',
     '356, weasel',
     '357, mink',
     '358, polecat',
     '359, black-footed_ferret',
     '360, otter',
     '361, skunk',
     '362, badger',
     '363, armadillo',
     '364, three-toed_sloth',
     '365, orangutan',
     '366, gorilla',
     '367, chimpanzee',
     '368, gibbon',
     '369, siamang',
     '370, guenon',
     '371, patas',
     '372, baboon',
     '373, macaque',
     '374, langur',
     '375, colobus',
     '376, proboscis_monkey',
     '377, marmoset',
     '378, capuchin',
     '379, howler_monkey',
     '380, titi',
     '381, spider_monkey',
     '382, squirrel_monkey',
     '383, Madagascar_cat',
     '384, indri',
     '385, Indian_elephant',
     '386, African_elephant',
     '387, lesser_panda',
     '388, giant_panda',
     '389, barracouta',
     '390, eel',
     '391, coho',
     '392, rock_beauty',
     '393, anemone_fish',
     '394, sturgeon',
     '395, gar',
     '396, lionfish',
     '397, puffer',
     '398, abacus',
     '399, abaya',
     '400, academic_gown',
     '401, accordion',
     '402, acoustic_guitar',
     '403, aircraft_carrier',
     '404, airliner',
     '405, airship',
     '406, altar',
     '407, ambulance',
     '408, amphibian',
     '409, analog_clock',
     '410, apiary',
     '411, apron',
     '412, ashcan',
     '413, assault_rifle',
     '414, backpack',
     '415, bakery',
     '416, balance_beam',
     '417, balloon',
     '418, ballpoint',
     '419, Band_Aid',
     '420, banjo',
     '421, bannister',
     '422, barbell',
     '423, barber_chair',
     '424, barbershop',
     '425, barn',
     '426, barometer',
     '427, barrel',
     '428, barrow',
     '429, baseball',
     '430, basketball',
     '431, bassinet',
     '432, bassoon',
     '433, bathing_cap',
     '434, bath_towel',
     '435, bathtub',
     '436, beach_wagon',
     '437, beacon',
     '438, beaker',
     '439, bearskin',
     '440, beer_bottle',
     '441, beer_glass',
     '442, bell_cote',
     '443, bib',
     '444, bicycle-built-for-two',
     '445, bikini',
     '446, binder',
     '447, binoculars',
     '448, birdhouse',
     '449, boathouse',
     '450, bobsled',
     '451, bolo_tie',
     '452, bonnet',
     '453, bookcase',
     '454, bookshop',
     '455, bottlecap',
     '456, bow',
     '457, bow_tie',
     '458, brass',
     '459, brassiere',
     '460, breakwater',
     '461, breastplate',
     '462, broom',
     '463, bucket',
     '464, buckle',
     '465, bulletproof_vest',
     '466, bullet_train',
     '467, butcher_shop',
     '468, cab',
     '469, caldron',
     '470, candle',
     '471, cannon',
     '472, canoe',
     '473, can_opener',
     '474, cardigan',
     '475, car_mirror',
     '476, carousel',
     "477, carpenter's_kit",
     '478, carton',
     '479, car_wheel',
     '480, cash_machine',
     '481, cassette',
     '482, cassette_player',
     '483, castle',
     '484, catamaran',
     '485, CD_player',
     '486, cello',
     '487, cellular_telephone',
     '488, chain',
     '489, chainlink_fence',
     '490, chain_mail',
     '491, chain_saw',
     '492, chest',
     '493, chiffonier',
     '494, chime',
     '495, china_cabinet',
     '496, Christmas_stocking',
     '497, church',
     '498, cinema',
     '499, cleaver',
     '500, cliff_dwelling',
     '501, cloak',
     '502, clog',
     '503, cocktail_shaker',
     '504, coffee_mug',
     '505, coffeepot',
     '506, coil',
     '507, combination_lock',
     '508, computer_keyboard',
     '509, confectionery',
     '510, container_ship',
     '511, convertible',
     '512, corkscrew',
     '513, cornet',
     '514, cowboy_boot',
     '515, cowboy_hat',
     '516, cradle',
     '517, crane',
     '518, crash_helmet',
     '519, crate',
     '520, crib',
     '521, Crock_Pot',
     '522, croquet_ball',
     '523, crutch',
     '524, cuirass',
     '525, dam',
     '526, desk',
     '527, desktop_computer',
     '528, dial_telephone',
     '529, diaper',
     '530, digital_clock',
     '531, digital_watch',
     '532, dining_table',
     '533, dishrag',
     '534, dishwasher',
     '535, disk_brake',
     '536, dock',
     '537, dogsled',
     '538, dome',
     '539, doormat',
     '540, drilling_platform',
     '541, drum',
     '542, drumstick',
     '543, dumbbell',
     '544, Dutch_oven',
     '545, electric_fan',
     '546, electric_guitar',
     '547, electric_locomotive',
     '548, entertainment_center',
     '549, envelope',
     '550, espresso_maker',
     '551, face_powder',
     '552, feather_boa',
     '553, file',
     '554, fireboat',
     '555, fire_engine',
     '556, fire_screen',
     '557, flagpole',
     '558, flute',
     '559, folding_chair',
     '560, football_helmet',
     '561, forklift',
     '562, fountain',
     '563, fountain_pen',
     '564, four-poster',
     '565, freight_car',
     '566, French_horn',
     '567, frying_pan',
     '568, fur_coat',
     '569, garbage_truck',
     '570, gasmask',
     '571, gas_pump',
     '572, goblet',
     '573, go-kart',
     '574, golf_ball',
     '575, golfcart',
     '576, gondola',
     '577, gong',
     '578, gown',
     '579, grand_piano',
     '580, greenhouse',
     '581, grille',
     '582, grocery_store',
     '583, guillotine',
     '584, hair_slide',
     '585, hair_spray',
     '586, half_track',
     '587, hammer',
     '588, hamper',
     '589, hand_blower',
     '590, hand-held_computer',
     '591, handkerchief',
     '592, hard_disc',
     '593, harmonica',
     '594, harp',
     '595, harvester',
     '596, hatchet',
     '597, holster',
     '598, home_theater',
     '599, honeycomb',
     '600, hook',
     '601, hoopskirt',
     '602, horizontal_bar',
     '603, horse_cart',
     '604, hourglass',
     '605, iPod',
     '606, iron',
     "607, jack-o'-lantern",
     '608, jean',
     '609, jeep',
     '610, jersey',
     '611, jigsaw_puzzle',
     '612, jinrikisha',
     '613, joystick',
     '614, kimono',
     '615, knee_pad',
     '616, knot',
     '617, lab_coat',
     '618, ladle',
     '619, lampshade',
     '620, laptop',
     '621, lawn_mower',
     '622, lens_cap',
     '623, letter_opener',
     '624, library',
     '625, lifeboat',
     '626, lighter',
     '627, limousine',
     '628, liner',
     '629, lipstick',
     '630, Loafer',
     '631, lotion',
     '632, loudspeaker',
     '633, loupe',
     '634, lumbermill',
     '635, magnetic_compass',
     '636, mailbag',
     '637, mailbox',
     '638, maillot',
     '639, maillot',
     '640, manhole_cover',
     '641, maraca',
     '642, marimba',
     '643, mask',
     '644, matchstick',
     '645, maypole',
     '646, maze',
     '647, measuring_cup',
     '648, medicine_chest',
     '649, megalith',
     '650, microphone',
     '651, microwave',
     '652, military_uniform',
     '653, milk_can',
     '654, minibus',
     '655, miniskirt',
     '656, minivan',
     '657, missile',
     '658, mitten',
     '659, mixing_bowl',
     '660, mobile_home',
     '661, Model_T',
     '662, modem',
     '663, monastery',
     '664, monitor',
     '665, moped',
     '666, mortar',
     '667, mortarboard',
     '668, mosque',
     '669, mosquito_net',
     '670, motor_scooter',
     '671, mountain_bike',
     '672, mountain_tent',
     '673, mouse',
     '674, mousetrap',
     '675, moving_van',
     '676, muzzle',
     '677, nail',
     '678, neck_brace',
     '679, necklace',
     '680, nipple',
     '681, notebook',
     '682, obelisk',
     '683, oboe',
     '684, ocarina',
     '685, odometer',
     '686, oil_filter',
     '687, organ',
     '688, oscilloscope',
     '689, overskirt',
     '690, oxcart',
     '691, oxygen_mask',
     '692, packet',
     '693, paddle',
     '694, paddlewheel',
     '695, padlock',
     '696, paintbrush',
     '697, pajama',
     '698, palace',
     '699, panpipe',
     '700, paper_towel',
     '701, parachute',
     '702, parallel_bars',
     '703, park_bench',
     '704, parking_meter',
     '705, passenger_car',
     '706, patio',
     '707, pay-phone',
     '708, pedestal',
     '709, pencil_box',
     '710, pencil_sharpener',
     '711, perfume',
     '712, Petri_dish',
     '713, photocopier',
     '714, pick',
     '715, pickelhaube',
     '716, picket_fence',
     '717, pickup',
     '718, pier',
     '719, piggy_bank',
     '720, pill_bottle',
     '721, pillow',
     '722, ping-pong_ball',
     '723, pinwheel',
     '724, pirate',
     '725, pitcher',
     '726, plane',
     '727, planetarium',
     '728, plastic_bag',
     '729, plate_rack',
     '730, plow',
     '731, plunger',
     '732, Polaroid_camera',
     '733, pole',
     '734, police_van',
     '735, poncho',
     '736, pool_table',
     '737, pop_bottle',
     '738, pot',
     "739, potter's_wheel",
     '740, power_drill',
     '741, prayer_rug',
     '742, printer',
     '743, prison',
     '744, projectile',
     '745, projector',
     '746, puck',
     '747, punching_bag',
     '748, purse',
     '749, quill',
     '750, quilt',
     '751, racer',
     '752, racket',
     '753, radiator',
     '754, radio',
     '755, radio_telescope',
     '756, rain_barrel',
     '757, recreational_vehicle',
     '758, reel',
     '759, reflex_camera',
     '760, refrigerator',
     '761, remote_control',
     '762, restaurant',
     '763, revolver',
     '764, rifle',
     '765, rocking_chair',
     '766, rotisserie',
     '767, rubber_eraser',
     '768, rugby_ball',
     '769, rule',
     '770, running_shoe',
     '771, safe',
     '772, safety_pin',
     '773, saltshaker',
     '774, sandal',
     '775, sarong',
     '776, sax',
     '777, scabbard',
     '778, scale',
     '779, school_bus',
     '780, schooner',
     '781, scoreboard',
     '782, screen',
     '783, screw',
     '784, screwdriver',
     '785, seat_belt',
     '786, sewing_machine',
     '787, shield',
     '788, shoe_shop',
     '789, shoji',
     '790, shopping_basket',
     '791, shopping_cart',
     '792, shovel',
     '793, shower_cap',
     '794, shower_curtain',
     '795, ski',
     '796, ski_mask',
     '797, sleeping_bag',
     '798, slide_rule',
     '799, sliding_door',
     '800, slot',
     '801, snorkel',
     '802, snowmobile',
     '803, snowplow',
     '804, soap_dispenser',
     '805, soccer_ball',
     '806, sock',
     '807, solar_dish',
     '808, sombrero',
     '809, soup_bowl',
     '810, space_bar',
     '811, space_heater',
     '812, space_shuttle',
     '813, spatula',
     '814, speedboat',
     '815, spider_web',
     '816, spindle',
     '817, sports_car',
     '818, spotlight',
     '819, stage',
     '820, steam_locomotive',
     '821, steel_arch_bridge',
     '822, steel_drum',
     '823, stethoscope',
     '824, stole',
     '825, stone_wall',
     '826, stopwatch',
     '827, stove',
     '828, strainer',
     '829, streetcar',
     '830, stretcher',
     '831, studio_couch',
     '832, stupa',
     '833, submarine',
     '834, suit',
     '835, sundial',
     '836, sunglass',
     '837, sunglasses',
     '838, sunscreen',
     '839, suspension_bridge',
     '840, swab',
     '841, sweatshirt',
     '842, swimming_trunks',
     '843, swing',
     '844, switch',
     '845, syringe',
     '846, table_lamp',
     '847, tank',
     '848, tape_player',
     '849, teapot',
     '850, teddy',
     '851, television',
     '852, tennis_ball',
     '853, thatch',
     '854, theater_curtain',
     '855, thimble',
     '856, thresher',
     '857, throne',
     '858, tile_roof',
     '859, toaster',
     '860, tobacco_shop',
     '861, toilet_seat',
     '862, torch',
     '863, totem_pole',
     '864, tow_truck',
     '865, toyshop',
     '866, tractor',
     '867, trailer_truck',
     '868, tray',
     '869, trench_coat',
     '870, tricycle',
     '871, trimaran',
     '872, tripod',
     '873, triumphal_arch',
     '874, trolleybus',
     '875, trombone',
     '876, tub',
     '877, turnstile',
     '878, typewriter_keyboard',
     '879, umbrella',
     '880, unicycle',
     '881, upright',
     '882, vacuum',
     '883, vase',
     '884, vault',
     '885, velvet',
     '886, vending_machine',
     '887, vestment',
     '888, viaduct',
     '889, violin',
     '890, volleyball',
     '891, waffle_iron',
     '892, wall_clock',
     '893, wallet',
     '894, wardrobe',
     '895, warplane',
     '896, washbasin',
     '897, washer',
     '898, water_bottle',
     '899, water_jug',
     '900, water_tower',
     '901, whiskey_jug',
     '902, whistle',
     '903, wig',
     '904, window_screen',
     '905, window_shade',
     '906, Windsor_tie',
     '907, wine_bottle',
     '908, wing',
     '909, wok',
     '910, wooden_spoon',
     '911, wool',
     '912, worm_fence',
     '913, wreck',
     '914, yawl',
     '915, yurt',
     '916, web_site',
     '917, comic_book',
     '918, crossword_puzzle',
     '919, street_sign',
     '920, traffic_light',
     '921, book_jacket',
     '922, menu',
     '923, plate',
     '924, guacamole',
     '925, consomme',
     '926, hot_pot',
     '927, trifle',
     '928, ice_cream',
     '929, ice_lolly',
     '930, French_loaf',
     '931, bagel',
     '932, pretzel',
     '933, cheeseburger',
     '934, hotdog',
     '935, mashed_potato',
     '936, head_cabbage',
     '937, broccoli',
     '938, cauliflower',
     '939, zucchini',
     '940, spaghetti_squash',
     '941, acorn_squash',
     '942, butternut_squash',
     '943, cucumber',
     '944, artichoke',
     '945, bell_pepper',
     '946, cardoon',
     '947, mushroom',
     '948, Granny_Smith',
     '949, strawberry',
     '950, orange',
     '951, lemon',
     '952, fig',
     '953, pineapple',
     '954, banana',
     '955, jackfruit',
     '956, custard_apple',
     '957, pomegranate',
     '958, hay',
     '959, carbonara',
     '960, chocolate_sauce',
     '961, dough',
     '962, meat_loaf',
     '963, pizza',
     '964, potpie',
     '965, burrito',
     '966, red_wine',
     '967, espresso',
     '968, cup',
     '969, eggnog',
     '970, alp',
     '971, bubble',
     '972, cliff',
     '973, coral_reef',
     '974, geyser',
     '975, lakeside',
     '976, promontory',
     '977, sandbar',
     '978, seashore',
     '979, valley',
     '980, volcano',
     '981, ballplayer',
     '982, groom',
     '983, scuba_diver',
     '984, rapeseed',
     '985, daisy',
     "986, yellow_lady's_slipper",
     '987, corn',
     '988, acorn',
     '989, hip',
     '990, buckeye',
     '991, coral_fungus',
     '992, agaric',
     '993, gyromitra',
     '994, stinkhorn',
     '995, earthstar',
     '996, hen-of-the-woods',
     '997, bolete',
     '998, ear',
     '999, toilet_tissue',
     ...]




```python
max_out = torch.argmax(out)
```


```python
max_out
```




    tensor(445)




```python
_, indices = torch.sort(out, descending=True)
idd = torch.squeeze(indices)
```


```python
# 显示最有可能的n类
for i in range(10):
    print(classes[idd[i]])
```

    445, bikini
    838, sunscreen
    459, brassiere
    591, handkerchief
    692, packet
    529, diaper
    684, ocarina
    631, lotion
    414, backpack
    709, pencil_box



```python

```

## 自定义神经网络
该网络有3层

- 第一层input layer，有784个神经元（MNIST数据集是28*28的单通道图片，故有784个神经元）
- 第二层为hidden_layer，设置为500个神经元
- 最后一层是输出层，有10个神经元（10分类任务）
- 在第二层之后还有个ReLU函数，进行非线性变换


```python
import torch
import torchvision
import torchvision.transforms as transforms
import torch.utils.data.dataloader as dataloader
import torch.nn as nn
import torch.optim as optim
import os
os.environ["CUDA_VISIBLE_DEVICES"] = "3"


train_set = torchvision.datasets.MNIST(
    # root="./data",
    root="C:\\Users\\Doiya\\Desktop\\PythonProject\\Pytorch_Lrean\\data",
    train=True,
    transform=transforms.ToTensor(),
    download=True
)
train_loader = dataloader.DataLoader(
    dataset=train_set,
    batch_size=100,
    shuffle=False,
)

test_set = torchvision.datasets.MNIST(
    # root="./data",
    root="C:\\Users\\Doiya\\Desktop\\PythonProject\\Pytorch_Lrean\\data",
    train=False,
    transform=transforms.ToTensor(),
    download=True
)
test_loader = dataloader.DataLoader(
    dataset=test_set,
    batch_size=100,
    shuffle=False,
)

class NeuralNet(nn.Module):

    def __init__(self, input_num, hidden_num, output_num):
        super(NeuralNet, self).__init__()
        # 隐层
        self.fc1 = nn.Linear(input_num, hidden_num)
        # 输出层
        self.fc2 = nn.Linear(hidden_num, output_num)
        # 激活函数
        self.relu = nn.ReLU()

    def forward(self,x):
        # 前向模型
        x = self.fc1(x)
        x = self.relu(x)
        y = self.fc2(x)
        return y

# 训练批次
epoches = 3
# 学习率learnRate
lr = 0.001
# 输入层维度
input_num = 784
# 隐层维度
hidden_num = 500
# 输出层维度
output_num = 10
# 选择cpu/gpu
device = torch.device("cuda" if torch.cuda.is_available() else "cpu")

# 初始化模型
model = NeuralNet(input_num, hidden_num, output_num)
model.to(device)
# 交叉熵损失函数
criterion = nn.CrossEntropyLoss()
# 优化器
optimizer = optim.Adam(model.parameters(), lr=lr)


for epoch in range(epoches):
    for i, data in enumerate(train_loader):
        (images, labels) = data
        images = images.reshape(-1, 28*28).to(device)
        labels = labels.to(device)

        output = model(images)
        loss = criterion(output, labels)
        optimizer.zero_grad()
        loss.backward()
        optimizer.step()

        if (i+1) % 100 == 0:
            print('Epoch [{}/{}], Loss: {:.4f}'
                  .format(epoch + 1, epoches, loss.item()))


with torch.no_grad():
    correct = 0
    total = 0
    for images, labels in test_loader:
        images = images.reshape(-1, 28*28).to(device)
        labels = labels.to(device)
        output = model(images)
        _, predicted = torch.max(output, 1)
        total += labels.size(0)
        correct += (predicted == labels).sum().item()

    print("The accuracy of total {} images: {}%".format(total, 100 * correct/total))
```

    Epoch [1/3], Loss: 0.1862
    Epoch [1/3], Loss: 0.3103
    Epoch [1/3], Loss: 0.3723
    Epoch [1/3], Loss: 0.3159
    Epoch [1/3], Loss: 0.2348
    Epoch [1/3], Loss: 0.2382
    Epoch [2/3], Loss: 0.0982
    Epoch [2/3], Loss: 0.1150
    Epoch [2/3], Loss: 0.1645
    Epoch [2/3], Loss: 0.1601
    Epoch [2/3], Loss: 0.1165
    Epoch [2/3], Loss: 0.1872
    Epoch [3/3], Loss: 0.0579
    Epoch [3/3], Loss: 0.0804
    Epoch [3/3], Loss: 0.0842
    Epoch [3/3], Loss: 0.0926
    Epoch [3/3], Loss: 0.0673
    Epoch [3/3], Loss: 0.1595
    The accuracy of total 10000 images: 96.67%


总结：
- 预先加载训练集和测试集
- 预先定制模型框架，占位符
- 初始化训练参数，初始化模型
- 开始加载数据集进行训练
- 训练结束，调用测试集得出正确率

调参：
- 不变学习率lr，增加epoches，可以提高准确率 (3->4->5->10):(96.41% ->97.31% -> 97.38% ->97.58%)
- 不变epoches，调低学习率lr，会使得拟合速度变慢 (0.001->0.0001->0.00001):(96.41% ->93.1% ->83.8%) 需要增加epoches
- 不变epoches，调高学习率lr，会使得拟合速度变快，但却没法达到最优 需要寻找合适的lr

### CIFAR10
更改训练集为CIFAR10


```python
import torch
import torchvision
import torchvision.transforms as transforms
import torch.utils.data.dataloader as dataloader
import torch.nn as nn
import torch.optim as optim
import os
os.environ["CUDA_VISIBLE_DEVICES"] = "3"


train_set = torchvision.datasets.CIFAR10(
    # root="./data",
    root="C:\\Users\\Doiya\\Desktop\\PythonProject\\Pytorch_Lrean\\cifar-10-python",
    train=True,
    transform=transforms.ToTensor(),
    download=True
)
train_loader = dataloader.DataLoader(
    dataset=train_set,
    batch_size=100,
    shuffle=False,
)

test_set = torchvision.datasets.CIFAR10(
    # root="./data",
    root="C:\\Users\\Doiya\\Desktop\\PythonProject\\Pytorch_Lrean\\cifar-10-python",
    train=False,
    transform=transforms.ToTensor(),
    download=True
)
test_loader = dataloader.DataLoader(
    dataset=test_set,
    batch_size=100,
    shuffle=False,
)

class NeuralNet(nn.Module):

    def __init__(self, input_num, hidden_num, output_num):
        super(NeuralNet, self).__init__()
        self.fc1 = nn.Linear(input_num, hidden_num)
        self.fc2 = nn.Linear(hidden_num, output_num)
        self.relu = nn.ReLU()

    def forward(self,x):
        x = self.fc1(x)
        x = self.relu(x)
        y = self.fc2(x)
        return y


epoches = 3
lr = 0.001
input_num = 3072
hidden_num = 500
output_num = 10
device = torch.device("cuda" if torch.cuda.is_available() else "cpu")

model = NeuralNet(input_num, hidden_num, output_num)
model.to(device)
criterion = nn.CrossEntropyLoss()
optimizer = optim.Adam(model.parameters(), lr=lr)


for epoch in range(epoches):
    for i, data in enumerate(train_loader):
        (images, labels) = data
        images = images.reshape(-1, 32*32*3).to(device)
        labels = labels.to(device)

        output = model(images)
        loss = criterion(output, labels)
        optimizer.zero_grad()
        loss.backward()
        optimizer.step()

        if (i+1) % 100 == 0:
            print('Epoch [{}/{}], Loss: {:.4f}'
                  .format(epoch + 1, epoches, loss.item()))


with torch.no_grad():
    correct = 0
    total = 0
    for images, labels in test_loader:
        images = images.reshape(-1, 32*32*3).to(device)
        labels = labels.to(device)
        output = model(images)
        _, predicted = torch.max(output, 1)
        total += labels.size(0)
        correct += (predicted == labels).sum().item()

    print("The accuracy of total {} images: {}%".format(total, 100 * correct/total))
```

    Files already downloaded and verified
    Files already downloaded and verified
    Epoch [1/3], Loss: 1.9865
    Epoch [1/3], Loss: 1.9773
    Epoch [1/3], Loss: 1.6489
    Epoch [1/3], Loss: 1.7570
    Epoch [1/3], Loss: 1.8290
    Epoch [2/3], Loss: 1.8332
    Epoch [2/3], Loss: 1.7649
    Epoch [2/3], Loss: 1.5115
    Epoch [2/3], Loss: 1.6438
    Epoch [2/3], Loss: 1.7872
    Epoch [3/3], Loss: 1.6837
    Epoch [3/3], Loss: 1.6501
    Epoch [3/3], Loss: 1.4655
    Epoch [3/3], Loss: 1.5709
    Epoch [3/3], Loss: 1.7418
    The accuracy of total 10000 images: 43.84%


更改模型，改为4层，中间两层隐层


```python
import torch
import torchvision
import torchvision.transforms as transforms
import torch.utils.data.dataloader as dataloader
import torch.nn as nn
import torch.optim as optim
import os
os.environ["CUDA_VISIBLE_DEVICES"] = "3"


train_set = torchvision.datasets.CIFAR10(
    # root="./data",
    root="C:\\Users\\Doiya\\Desktop\\PythonProject\\Pytorch_Lrean\\cifar-10-python",
    train=True,
    transform=transforms.ToTensor(),
    download=True
)
train_loader = dataloader.DataLoader(
    dataset=train_set,
    batch_size=100,
    shuffle=False,
)

test_set = torchvision.datasets.CIFAR10(
    # root="./data",
    root="C:\\Users\\Doiya\\Desktop\\PythonProject\\Pytorch_Lrean\\cifar-10-python",
    train=False,
    transform=transforms.ToTensor(),
    download=True
)
test_loader = dataloader.DataLoader(
    dataset=test_set,
    batch_size=100,
    shuffle=False,
)

class NeuralNet(nn.Module):

    def __init__(self, input_num, hidden_num, output_num):
        super(NeuralNet, self).__init__()
        self.fc1 = nn.Linear(input_num, hidden1_num)
        self.fc2 = nn.Linear(hidden1_num, hidden2_num)
        self.fc3 = nn.Linear(hidden2_num, output_num)
        self.relu = nn.ReLU()

    def forward(self,x):
        x = self.fc1(x)
        x = self.relu(x)
        x = self.fc2(x)
        x = self.relu(x)
        y = self.fc3(x)
        return y


epoches = 5
lr = 0.001
input_num = 3072
hidden1_num = 1500
hidden2_num = 500
output_num = 10
device = torch.device("cuda" if torch.cuda.is_available() else "cpu")

model = NeuralNet(input_num, hidden_num, output_num)
model.to(device)
criterion = nn.CrossEntropyLoss()
optimizer = optim.Adam(model.parameters(), lr=lr)


for epoch in range(epoches):
    for i, data in enumerate(train_loader):
        (images, labels) = data
        images = images.reshape(-1, 32*32*3).to(device)
        labels = labels.to(device)

        output = model(images)
        loss = criterion(output, labels)
        optimizer.zero_grad()
        loss.backward()
        optimizer.step()

        if (i+1) % 100 == 0:
            print('Epoch [{}/{}], Loss: {:.4f}'
                  .format(epoch + 1, epoches, loss.item()))


with torch.no_grad():
    correct = 0
    total = 0
    for images, labels in test_loader:
        images = images.reshape(-1, 32*32*3).to(device)
        labels = labels.to(device)
        output = model(images)
        _, predicted = torch.max(output, 1)
        total += labels.size(0)
        correct += (predicted == labels).sum().item()

    print("The accuracy of total {} images: {}%".format(total, 100 * correct/total))
```

    Files already downloaded and verified
    Files already downloaded and verified
    Epoch [1/5], Loss: 1.9782
    Epoch [1/5], Loss: 1.8332
    Epoch [1/5], Loss: 1.6163
    Epoch [1/5], Loss: 1.7119
    Epoch [1/5], Loss: 1.8233
    Epoch [2/5], Loss: 1.7197
    Epoch [2/5], Loss: 1.6535
    Epoch [2/5], Loss: 1.4919
    Epoch [2/5], Loss: 1.5751
    Epoch [2/5], Loss: 1.7088
    Epoch [3/5], Loss: 1.5537
    Epoch [3/5], Loss: 1.5297
    Epoch [3/5], Loss: 1.4098
    Epoch [3/5], Loss: 1.4532
    Epoch [3/5], Loss: 1.6331
    Epoch [4/5], Loss: 1.5043
    Epoch [4/5], Loss: 1.5009
    Epoch [4/5], Loss: 1.3734
    Epoch [4/5], Loss: 1.4408
    Epoch [4/5], Loss: 1.5663
    Epoch [5/5], Loss: 1.4573
    Epoch [5/5], Loss: 1.4316
    Epoch [5/5], Loss: 1.3527
    Epoch [5/5], Loss: 1.3839
    Epoch [5/5], Loss: 1.4940
    The accuracy of total 10000 images: 48.59%


总结：
- 修改模型，增加隐层，并没有使得精度发生显著变化
- 修改参数，调整lr，并没有使得精度发生显著变化，甚至变小
- 修改参数，增加epoches，可以增加一点点精度

调参，提高准确率
- 增加epoches
- 调整lr
- 增加隐层

再增加一层隐层，测试是否能够提高精度


```python
import torch
import torchvision
import torchvision.transforms as transforms
import torch.utils.data.dataloader as dataloader
import torch.nn as nn
import torch.optim as optim
import os
os.environ["CUDA_VISIBLE_DEVICES"] = "3"


train_set = torchvision.datasets.CIFAR10(
    # root="./data",
    root="C:\\Users\\Doiya\\Desktop\\PythonProject\\Pytorch_Lrean\\cifar-10-python",
    train=True,
    transform=transforms.ToTensor(),
    download=True
)
train_loader = dataloader.DataLoader(
    dataset=train_set,
    batch_size=100,
    shuffle=False,
)

test_set = torchvision.datasets.CIFAR10(
    # root="./data",
    root="C:\\Users\\Doiya\\Desktop\\PythonProject\\Pytorch_Lrean\\cifar-10-python",
    train=False,
    transform=transforms.ToTensor(),
    download=True
)
test_loader = dataloader.DataLoader(
    dataset=test_set,
    batch_size=100,
    shuffle=False,
)

class NeuralNet(nn.Module):

    def __init__(self, input_num, hidden_num, output_num):
        super(NeuralNet, self).__init__()
        self.fc1 = nn.Linear(input_num, hidden1_num)
        self.fc2 = nn.Linear(hidden1_num, hidden2_num)
        self.fc3 = nn.Linear(hidden2_num, hidden3_num)
        self.fc4 = nn.Linear(hidden3_num, output_num)
        self.relu = nn.ReLU()

    def forward(self,x):
        x = self.fc1(x)
        x = self.relu(x)
        x = self.fc2(x)
        x = self.relu(x)
        x = self.fc3(x)
        x = self.relu(x)
        y = self.fc4(x)
        return y


epoches = 50
lr = 0.001
input_num = 3072
hidden1_num = 2000
hidden2_num = 1000
hidden3_num = 500
output_num = 10
device = torch.device("cuda" if torch.cuda.is_available() else "cpu")

model = NeuralNet(input_num, hidden_num, output_num)
model.to(device)
criterion = nn.CrossEntropyLoss()
optimizer = optim.Adam(model.parameters(), lr=lr)


for epoch in range(epoches):
    for i, data in enumerate(train_loader):
        (images, labels) = data
        images = images.reshape(-1, 32*32*3).to(device)
        labels = labels.to(device)

        output = model(images)
        loss = criterion(output, labels)
        optimizer.zero_grad()
        loss.backward()
        optimizer.step()

        if (i+1) % 100 == 0:
            print('Epoch [{}/{}], Loss: {:.4f}'
                  .format(epoch + 1, epoches, loss.item()))


with torch.no_grad():
    correct = 0
    total = 0
    for images, labels in test_loader:
        images = images.reshape(-1, 32*32*3).to(device)
        labels = labels.to(device)
        output = model(images)
        _, predicted = torch.max(output, 1)
        total += labels.size(0)
        correct += (predicted == labels).sum().item()

    print("The accuracy of total {} images: {}%".format(total, 100 * correct/total))
```

    Files already downloaded and verified
    Files already downloaded and verified
    Epoch [1/50], Loss: 2.0392
    Epoch [1/50], Loss: 1.8909
    Epoch [1/50], Loss: 1.6834
    Epoch [1/50], Loss: 1.7883
    Epoch [1/50], Loss: 1.8436
    Epoch [2/50], Loss: 1.7776
    Epoch [2/50], Loss: 1.7182
    Epoch [2/50], Loss: 1.5224
    Epoch [2/50], Loss: 1.5778
    Epoch [2/50], Loss: 1.7894
    Epoch [3/50], Loss: 1.5746
    Epoch [3/50], Loss: 1.7027
    Epoch [3/50], Loss: 1.4466
    Epoch [3/50], Loss: 1.4558
    Epoch [3/50], Loss: 1.6349
    Epoch [4/50], Loss: 1.5273
    Epoch [4/50], Loss: 1.6074
    Epoch [4/50], Loss: 1.4111
    Epoch [4/50], Loss: 1.3731
    Epoch [4/50], Loss: 1.6110
    Epoch [5/50], Loss: 1.5292
    Epoch [5/50], Loss: 1.5668
    Epoch [5/50], Loss: 1.3803
    Epoch [5/50], Loss: 1.3194
    Epoch [5/50], Loss: 1.5253
    Epoch [6/50], Loss: 1.4534
    Epoch [6/50], Loss: 1.4851
    Epoch [6/50], Loss: 1.3714
    Epoch [6/50], Loss: 1.2876
    Epoch [6/50], Loss: 1.5336
    Epoch [7/50], Loss: 1.5158
    Epoch [7/50], Loss: 1.4956
    Epoch [7/50], Loss: 1.3330
    Epoch [7/50], Loss: 1.3136
    Epoch [7/50], Loss: 1.5032
    Epoch [8/50], Loss: 1.4503
    Epoch [8/50], Loss: 1.4912
    Epoch [8/50], Loss: 1.2573
    Epoch [8/50], Loss: 1.2639
    Epoch [8/50], Loss: 1.4328
    Epoch [9/50], Loss: 1.4266
    Epoch [9/50], Loss: 1.4756
    Epoch [9/50], Loss: 1.2535
    Epoch [9/50], Loss: 1.1375
    Epoch [9/50], Loss: 1.4070
    Epoch [10/50], Loss: 1.3337
    Epoch [10/50], Loss: 1.4352
    Epoch [10/50], Loss: 1.1437
    Epoch [10/50], Loss: 1.2121
    Epoch [10/50], Loss: 1.3637
    Epoch [11/50], Loss: 1.2962
    Epoch [11/50], Loss: 1.4360
    Epoch [11/50], Loss: 1.1755
    Epoch [11/50], Loss: 1.2084
    Epoch [11/50], Loss: 1.3756
    Epoch [12/50], Loss: 1.2637
    Epoch [12/50], Loss: 1.4346
    Epoch [12/50], Loss: 1.1833
    Epoch [12/50], Loss: 1.2281
    Epoch [12/50], Loss: 1.2908
    Epoch [13/50], Loss: 1.2389
    Epoch [13/50], Loss: 1.3942
    Epoch [13/50], Loss: 1.0830
    Epoch [13/50], Loss: 1.1521
    Epoch [13/50], Loss: 1.2590
    Epoch [14/50], Loss: 1.2453
    Epoch [14/50], Loss: 1.2773
    Epoch [14/50], Loss: 1.0923
    Epoch [14/50], Loss: 0.9822
    Epoch [14/50], Loss: 1.1880
    Epoch [15/50], Loss: 1.2433
    Epoch [15/50], Loss: 1.3150
    Epoch [15/50], Loss: 1.0181
    Epoch [15/50], Loss: 1.0165
    Epoch [15/50], Loss: 1.1573
    Epoch [16/50], Loss: 1.3422
    Epoch [16/50], Loss: 1.3264
    Epoch [16/50], Loss: 0.9900
    Epoch [16/50], Loss: 1.0084
    Epoch [16/50], Loss: 1.0928
    Epoch [17/50], Loss: 1.2546
    Epoch [17/50], Loss: 1.3993
    Epoch [17/50], Loss: 1.0031
    Epoch [17/50], Loss: 1.0194
    Epoch [17/50], Loss: 1.0477
    Epoch [18/50], Loss: 1.2295
    Epoch [18/50], Loss: 1.3024
    Epoch [18/50], Loss: 0.9660
    Epoch [18/50], Loss: 1.1255
    Epoch [18/50], Loss: 0.9918
    Epoch [19/50], Loss: 1.2365
    Epoch [19/50], Loss: 1.3146
    Epoch [19/50], Loss: 0.9272
    Epoch [19/50], Loss: 0.9820
    Epoch [19/50], Loss: 1.0150
    Epoch [20/50], Loss: 1.2386
    Epoch [20/50], Loss: 1.3272
    Epoch [20/50], Loss: 0.9020
    Epoch [20/50], Loss: 1.0113
    Epoch [20/50], Loss: 0.9676
    Epoch [21/50], Loss: 1.2627
    Epoch [21/50], Loss: 1.1132
    Epoch [21/50], Loss: 0.9920
    Epoch [21/50], Loss: 0.9125
    Epoch [21/50], Loss: 1.0137
    Epoch [22/50], Loss: 1.2712
    Epoch [22/50], Loss: 1.1826
    Epoch [22/50], Loss: 0.9119
    Epoch [22/50], Loss: 0.8587
    Epoch [22/50], Loss: 1.0270
    Epoch [23/50], Loss: 1.1604
    Epoch [23/50], Loss: 1.2157
    Epoch [23/50], Loss: 0.8966
    Epoch [23/50], Loss: 0.8031
    Epoch [23/50], Loss: 1.0382
    Epoch [24/50], Loss: 1.2292
    Epoch [24/50], Loss: 1.1772
    Epoch [24/50], Loss: 0.8553
    Epoch [24/50], Loss: 0.7470
    Epoch [24/50], Loss: 1.0609
    Epoch [25/50], Loss: 1.1258
    Epoch [25/50], Loss: 1.1950
    Epoch [25/50], Loss: 0.8426
    Epoch [25/50], Loss: 0.7187
    Epoch [25/50], Loss: 0.9169
    Epoch [26/50], Loss: 1.0827
    Epoch [26/50], Loss: 1.1474
    Epoch [26/50], Loss: 0.7930
    Epoch [26/50], Loss: 0.7462
    Epoch [26/50], Loss: 0.8197
    Epoch [27/50], Loss: 1.1037
    Epoch [27/50], Loss: 1.1466
    Epoch [27/50], Loss: 0.8671
    Epoch [27/50], Loss: 0.7502
    Epoch [27/50], Loss: 0.8419
    Epoch [28/50], Loss: 0.9955
    Epoch [28/50], Loss: 1.1564
    Epoch [28/50], Loss: 0.7906
    Epoch [28/50], Loss: 0.7945
    Epoch [28/50], Loss: 0.8291
    Epoch [29/50], Loss: 1.1565
    Epoch [29/50], Loss: 1.1980
    Epoch [29/50], Loss: 0.8622
    Epoch [29/50], Loss: 0.8167
    Epoch [29/50], Loss: 1.0331
    Epoch [30/50], Loss: 1.1444
    Epoch [30/50], Loss: 1.0628
    Epoch [30/50], Loss: 0.8318
    Epoch [30/50], Loss: 0.7739
    Epoch [30/50], Loss: 1.0304
    Epoch [31/50], Loss: 1.0292
    Epoch [31/50], Loss: 1.1041
    Epoch [31/50], Loss: 0.8973
    Epoch [31/50], Loss: 1.0070
    Epoch [31/50], Loss: 1.0615
    Epoch [32/50], Loss: 0.9569
    Epoch [32/50], Loss: 1.1429
    Epoch [32/50], Loss: 0.8875
    Epoch [32/50], Loss: 0.8428
    Epoch [32/50], Loss: 0.7863
    Epoch [33/50], Loss: 1.0931
    Epoch [33/50], Loss: 1.0101
    Epoch [33/50], Loss: 0.8156
    Epoch [33/50], Loss: 0.8297
    Epoch [33/50], Loss: 0.8611
    Epoch [34/50], Loss: 1.0303
    Epoch [34/50], Loss: 0.9588
    Epoch [34/50], Loss: 0.7385
    Epoch [34/50], Loss: 0.7755
    Epoch [34/50], Loss: 0.7564
    Epoch [35/50], Loss: 1.0156
    Epoch [35/50], Loss: 1.0101
    Epoch [35/50], Loss: 0.7670
    Epoch [35/50], Loss: 0.7084
    Epoch [35/50], Loss: 0.8552
    Epoch [36/50], Loss: 1.0397
    Epoch [36/50], Loss: 1.0350
    Epoch [36/50], Loss: 0.8202
    Epoch [36/50], Loss: 0.7438
    Epoch [36/50], Loss: 0.8967
    Epoch [37/50], Loss: 0.9643
    Epoch [37/50], Loss: 0.9434
    Epoch [37/50], Loss: 0.7437
    Epoch [37/50], Loss: 0.8399
    Epoch [37/50], Loss: 0.9461
    Epoch [38/50], Loss: 1.0724
    Epoch [38/50], Loss: 1.1219
    Epoch [38/50], Loss: 0.7823
    Epoch [38/50], Loss: 0.9263
    Epoch [38/50], Loss: 1.0643
    Epoch [39/50], Loss: 1.0109
    Epoch [39/50], Loss: 0.9450
    Epoch [39/50], Loss: 0.7426
    Epoch [39/50], Loss: 0.9110
    Epoch [39/50], Loss: 0.9728
    Epoch [40/50], Loss: 1.0020
    Epoch [40/50], Loss: 0.9588
    Epoch [40/50], Loss: 0.8160
    Epoch [40/50], Loss: 0.9129
    Epoch [40/50], Loss: 1.0041
    Epoch [41/50], Loss: 1.1040
    Epoch [41/50], Loss: 0.9870
    Epoch [41/50], Loss: 0.8838
    Epoch [41/50], Loss: 0.9590
    Epoch [41/50], Loss: 0.8837
    Epoch [42/50], Loss: 0.9920
    Epoch [42/50], Loss: 0.9908
    Epoch [42/50], Loss: 0.7167
    Epoch [42/50], Loss: 0.8715
    Epoch [42/50], Loss: 0.8917
    Epoch [43/50], Loss: 0.9384
    Epoch [43/50], Loss: 0.9991
    Epoch [43/50], Loss: 0.7235
    Epoch [43/50], Loss: 0.8509
    Epoch [43/50], Loss: 0.9426
    Epoch [44/50], Loss: 0.7928
    Epoch [44/50], Loss: 1.0860
    Epoch [44/50], Loss: 0.7337
    Epoch [44/50], Loss: 0.6786
    Epoch [44/50], Loss: 0.8277
    Epoch [45/50], Loss: 0.7707
    Epoch [45/50], Loss: 0.9440
    Epoch [45/50], Loss: 0.6278
    Epoch [45/50], Loss: 0.7913
    Epoch [45/50], Loss: 0.8654
    Epoch [46/50], Loss: 0.8741
    Epoch [46/50], Loss: 0.9480
    Epoch [46/50], Loss: 0.6143
    Epoch [46/50], Loss: 0.8133
    Epoch [46/50], Loss: 0.7938
    Epoch [47/50], Loss: 0.6782
    Epoch [47/50], Loss: 0.7801
    Epoch [47/50], Loss: 0.6691
    Epoch [47/50], Loss: 0.6937
    Epoch [47/50], Loss: 0.7381
    Epoch [48/50], Loss: 0.7192
    Epoch [48/50], Loss: 0.8655
    Epoch [48/50], Loss: 0.6992
    Epoch [48/50], Loss: 0.7149
    Epoch [48/50], Loss: 0.7401
    Epoch [49/50], Loss: 0.8445
    Epoch [49/50], Loss: 0.8914
    Epoch [49/50], Loss: 0.6221
    Epoch [49/50], Loss: 0.7861
    Epoch [49/50], Loss: 0.8256
    Epoch [50/50], Loss: 0.8589
    Epoch [50/50], Loss: 0.8524
    Epoch [50/50], Loss: 0.6874
    Epoch [50/50], Loss: 0.8814
    Epoch [50/50], Loss: 0.8241
    The accuracy of total 10000 images: 45.16%


结论：
- 即使模型隐层越多，epoches增加到50批次，loss下降到1以下，精度也没有改变，所以问题不是参数的问题，而是模型的问题，激活函数没起到很好的作用。
- 目前还没找到很好的解决办法，还得继续学习。

收获
- 通过已训练的模型，加载预训练的参数，进行神经网络的初使用，通过使用图片来得到预测的分类，感受到神经网络运作
- 自己一步一步的搭建神经网络，使用已有的训练集进行模型训练，得到自己的神经网络
- 调参的体验


```python

```
